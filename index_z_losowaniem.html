<!DOCTYPE html>
<html>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="chance.min.js"></script>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 75%; }
      #ui { height: 25%;}
    </style>
  </head>
  <body>
    <div id="map"></div>
    <div id="ui">Kilkniec: <span id="ilosc">0</span><button id="addmore">Dodaj</button><button id="start">Graj</button></div>
    <script>

var klikniec = 0;
var map;
var markers = [];
function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 50.0546501, lng: 19.96250153},
    zoom: 12
  });


  /*for (var i = 0; i < markers.length; i++) {
    (function (i){
    google.maps.event.addDomListener(markers[i], 'click', function() {
    klikniec++;
    $("#ilosc").text(klikniec);
    markers[i].setMap(null);
  });
})(i);

  }*/


}


// function addMarker(location) {
function addMarker() {
  var lngMin = 1981916428;
  var lngMax = 2010789900;
  var latMax = 5009242859;
  var latMin = 5001369614;
  var randomLat = (Math.floor(Math.random() * (latMax - latMin + 1)) + latMin)/100000000;
  var randomLng = (Math.floor(Math.random() * (lngMax - lngMin + 1)) + lngMin)/100000000;

  var marker = new google.maps.Marker({
    position: {lng: randomLng, lat: randomLat},
    map: map
  });

  google.maps.event.addDomListener(marker, 'click', function() {
  klikniec++;
  $("#ilosc").text(klikniec);
  marker.setMap(null);
});

  console.log(markers.push(marker));
}
function setMapOnAll(map) {
  for (var i = 0; i < markers.length; i++) {
    markers[i].setMap(map);
  }
}

function clearMarkers() {
  setMapOnAll(null);
}
function showMarkers() {
  setMapOnAll(map);
}
function deleteMarkers() {
  clearMarkers();
  markers = [];
}
  </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?callback=initMap">
    </script>
    <script>$("#addmore").click(function(){ addMarker()});
    $("#start").click(function()
  {
    for (var j = 1; j <= 20; j++)
    { window.setTimeout(function() {
addMarker()},3300 * j); }
  });
    </script>
  </body>
</html>
